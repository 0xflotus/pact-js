language: node_js
node_js:
- '4'
- '5'
- '6'
matrix:
  fast_finish: true
env:
  matrix:
  - CXX=g++-4.8
  global:
  - secure: ju30KDpSYrw+nd2MmZTOjCTJu+gFNDy9auc6h/K9HhWgGX9zQ2cX0Vq4LX5EHWCImyPoVuyuxiouHoWB/eYcDtyDUoXb+EzNn/i+JXVWteQVRdbgnbDNHccGIpMYwEBrslg+iZWz5/SuxeqB/R0jd7MDK6oQBhWKAXgEYNOBEnRh814jryf93gQc8s4gONq2QoSiFk5QwDfqbvoK2o/4RsGGu3YBxy9/O8LhPTiI9YpdtjxmQtdgbchXLU0/oxv/7P/Etc5Z/0uqRwuF6YMZhJE6FT4ytLCDjaldYyMUAQ2YCT13UfouOO2gZYG0w+zpVGJ+e0hi/+6y1BCew/qNwTylMapcMpMCOsc2XLLD0HZoDrYprx8nUjZd0X859Rod+AWWEQnUhtFR7vqv69zwaH5TFR6l9uh+TragdgWUhJvWvupl1i26JBh0G1dFfWaU+rK/bmcsHK2ioPz2Ij+XrEdJV4KFtc7HPDWV1nCmiX5LA+cypDdfCNQehIufe6gArUUsV/vwtyEkTeOwzJAFgvOgufeZSivhttm/loalD1kX1JLrdR1ebxARvK2zSszeBYlFBwGCuK6sWup5Ace5TX39Ff6TRyO3YCTzaOd6k4w+Fsk93SkKLhGrDby21yIcmrkPdpDLjvR70SLb+OepemISktQpeMPrBTdfQU3J5G4=
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
before_install:
- npm install mitm
script: npm run dist
after_success:
- npm run coverage
before_deploy:
- tar -czvf pactjs.tar.gz config dist src package.json README.md LICENSE
deploy:
- provider: releases
  api_key:
    secure: ZBpri/YS2HLBvsPsHHQYBkQNgjat5sc/07wN6J3vLS/4ahZqmMFhRkl1gHwjZyt+XUmaKeo9Pa0zt1l3rZHuFMPlXBqRU3uPOAA5QEfM5BrU13hdHLIiSryE9S86I4wnF6ey6x/D51Ux6jypk/4e1/R0MEQPCIdmlvBWz/ZcCC3j/nir+BTt8Sx5XhOi+Etq4DUjQk8w8zSOV1HnP6jcJgbRsjVcC/to0v/ztPA6uoL9Hx1rvse9iP3lMK0wi8IEwe2GcAZe3NcKIbEw+hZv9VGHMzXlVzJQN7xStF1b7g9WKWJ5YIADFhfwl80vTVsdIyPnicqhWbyNLq7Q981sFGoKIy5GquXdlYNFPddHXXnbz/1EKrwrvgEyEBcSa0rFsJ8g3fC540ZQVyXBVh65Z5STyWdBKwCAltCb4tkUw5uHQndvJUj/kupjXNJNL39+UPy47Wc9kfwjOqLvUVL7F4ewD19dKp+PfxnCNf6RH2kx1Lh5YSrIL0TUUMp8vD9i2s3Nh7VOF8ni86ZZdjA9w9tNbU72b8q0mfHtKwTM1fPdPSfITYe3LgYhHdIuVUo5ov6xt84sevSN8vQchBOXSXmPsxmwcIVkxfY57dhRXonlcXFL6kh9kVucZYQvP4DY8fhPb98fuzBXB1FRCEZIWNra1L10F9zZqF3OF5JqZjo=
  file: pactjs.tar.gz
  skip_cleanup: true
  on:
    tags: true
    node: '6'
- provider: npm
  api_key:
    secure: Ym2+NtwSgfTu+WjpxML01op5fLkGgUzgMk5p/cOwfhAfmIlGnYcuesNBmd0AfrPTLQpUixLQ/HIYleM9DJIyR+fRBpWrEZyRdu5F+F3tNYUTpGK0tV0C0yUWE8Byz1z+4FLCab8cfrYZPtWzOQlOxWSHKxrHqhVLnoTclJL1nLRBjgVLMs+qX1z66tZdm08GPiu+NCtssOBkOMuQv8OmXme/l6HcM+AkMfjtwBRWF7rovNCSF51EU0cWjPODMhIOPcQw+g59UPbDGKcW7fSCfzdokH+knuv6Xb4EaSqdVFHdaZONZ6dER4pXZcw1HN9Bc7aJ7B5MSfIVwklcb+xdCM49HciYe1j5yzX4mhqA0NnKDTqSSTQSs2RWwDo1ES5bqEEVnfPXoH8gDqsYixkWDNim4c+O4GNeoobuEPHt0snbKCOaxkWpU/Qe1bXSxz+3hD8/SsS6Q0cfh/H5dTHwNr/FiJTKrfby/BdwI0YS1Mim/MqmhLusBp8lvNiwMaona62tmGNHDbu6AC3zLrg31RqOrXTGkAaPFqCxf1oo6cuyn4six75sQTs1G/QY2h1r06PdpLpuwoxLWdj75X8f3gk091RbktkWULqUSBNo0b8m6lzP8R4pQa3POs8WUgMktKn/OmIFPiblsv8yZ5hRBgOSurZkQQW+xrVdlpt2kF0=
  skip_cleanup: true
  on:
    tags: true
    node: '6'
